
> afrodita-backend@1.0.0 test
> jest

node.exe : PASS src/modules/services/services.service.spec.ts (8.017 s)
строка:1 знак:1
+ & "D:\Program Files\nodejs/node.exe" "D:\Program Files\nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (PASS src/module...ec.ts (8.017 s):String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
PASS src/modules/appointments/appointments.service.spec.ts (8.395 s)
PASS src/tasks/scheduler.service.spec.ts (8.566 s)
PASS src/modules/masters/masters.controller.spec.ts (8.585 s)
PASS src/modules/notifications/notifications.controller.spec.ts (8.963 s)
[31m[Nest] 800  - [39m07.12.2025, 11:24:28 [31m  ERROR[39m [38;5;3m[TelegramBotService] [39m[31m╨Ю╤И╨╕╨▒╨║╨░ ╨┐╤А╨╕ ╨╖╨░╨┐╤Г╤Б╨║╨╡ ╨▒╨╛╤В╨░: 404: Not Found[39m
Error: 404: Not Found
    at Telegram.callApi (D:\GitHub\Afrodita\backend\node_modules\telegraf\lib\core\network\client.js:315:19)
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at Telegraf.launch (D:\GitHub\Afrodita\backend\node_modules\telegraf\lib\telegraf.js:188:78)
    at TelegramBotService.onModuleInit (D:\GitHub\Afrodita\backend\src\modules\telegram\telegram-bot.service.ts:116:7)
    at Object.<anonymous> (D:\GitHub\Afrodita\backend\src\modules\telegram\telegram-bot.service.spec.ts:208:7)
[31m[Nest] 800  - [39m07.12.2025, 11:24:28 [31m  ERROR[39m [38;5;3m[TelegramBotService] [39m[31m╨Ю╤И╨╕╨▒╨║╨░ ╨┐╤А╨╕ ╨╛╤В╨┐╤А╨░╨▓╨║╨╡ ╤Б╨╛╨╛╨▒╤Й╨╡╨╜╨╕╤П: Send failed[39m
PASS src/modules/auth/auth.controller.spec.ts (8.958 s)
PASS src/modules/telegram/telegram-bot.service.spec.ts (9.17 s)
PASS src/modules/services/services.controller.spec.ts
PASS src/modules/telegram/telegram.service.spec.ts
PASS src/modules/reviews/reviews.controller.spec.ts
PASS src/modules/analytics/analytics.controller.spec.ts
PASS src/modules/templates/templates.controller.spec.ts
PASS src/modules/appointments/appointments.controller.spec.ts
PASS src/modules/templates/templates.service.spec.ts
PASS src/modules/auth/strategies/jwt.strategy.spec.ts
PASS src/modules/users/users.controller.spec.ts
PASS src/modules/reviews/reviews.service.spec.ts
PASS src/modules/notifications/notifications.service.spec.ts
PASS src/modules/masters/masters.service.spec.ts
PASS src/modules/financial/financial.service.spec.ts
PASS src/modules/settings/settings.service.spec.ts
PASS src/modules/audit/audit.controller.spec.ts
PASS src/modules/settings/settings.controller.spec.ts
PASS src/modules/analytics/analytics.service.spec.ts
PASS src/modules/audit/audit.service.spec.ts
PASS src/modules/financial/financial.controller.spec.ts
PASS src/modules/telegram/telegram-chats.service.spec.ts
PASS src/modules/auth/guards/roles.guard.spec.ts
FAIL src/modules/users/users.service.spec.ts
  тЧП Test suite failed to run

    [96msrc/modules/users/users.service.spec.ts[0m:[93m374[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type '1' is not assignable to parameter of type 'UserRole'.

    [7m374[0m       await service.findAll(1, 20, search);
    [7m   [0m [91m                            ~[0m
    [96msrc/modules/users/users.service.spec.ts[0m:[93m390[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type '1' is not assignable to parameter of type 'UserRole'.

    [7m390[0m       await service.findAll(1, 20, undefined, isActive);
    [7m   [0m [91m                            ~[0m

FAIL src/modules/auth/auth.service.spec.ts
  тЧП Test suite failed to run

    [96msrc/modules/auth/auth.service.spec.ts[0m:[93m249[0m:[93m30[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; telegramId: number; firstName: string; lastName: string; userna
me: string; role: UserRole.CLIENT; }' to type 'User' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; telegramId: number; firstName: string; lastName: string; username: string; role: UserRole.CLIENT; }' is missing the following properties from type 'User': phone, email, password, bo
nusPoints, and 12 more.

    [7m249[0m       const mockUser: User = {
    [7m   [0m [91m                             ~[0m
    [7m250[0m         id: 'user-1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m255[0m         role: UserRole.CLIENT,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m256[0m       } as User;
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m
    [96msrc/modules/auth/auth.service.spec.ts[0m:[93m289[0m:[93m34[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; telegramId: number; firstName: string; lastName: string; userna
me: string; role: UserRole.CLIENT; }' to type 'User' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; telegramId: number; firstName: string; lastName: string; username: string; role: UserRole.CLIENT; }' is missing the following properties from type 'User': phone, email, password, bo
nusPoints, and 12 more.

    [7m289[0m       const existingUser: User = {
    [7m   [0m [91m                                 ~[0m
    [7m290[0m         id: 'user-1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m295[0m         role: UserRole.CLIENT,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m296[0m       } as User;
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m

Summary of all failing tests
FAIL modules/users/users.service.spec.ts
  тЧП Test suite failed to run

    [96msrc/modules/users/users.service.spec.ts[0m:[93m374[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type '1' is not assignable to parameter of type 'UserRole'.

    [7m374[0m       await service.findAll(1, 20, search);
    [7m   [0m [91m                            ~[0m
    [96msrc/modules/users/users.service.spec.ts[0m:[93m390[0m:[93m29[0m - [91merror[0m[90m TS2345: [0mArgument of type '1' is not assignable to parameter of type 'UserRole'.

    [7m390[0m       await service.findAll(1, 20, undefined, isActive);
    [7m   [0m [91m                            ~[0m

FAIL modules/auth/auth.service.spec.ts
  тЧП Test suite failed to run

    [96msrc/modules/auth/auth.service.spec.ts[0m:[93m249[0m:[93m30[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; telegramId: number; firstName: string; lastName: string; userna
me: string; role: UserRole.CLIENT; }' to type 'User' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; telegramId: number; firstName: string; lastName: string; username: string; role: UserRole.CLIENT; }' is missing the following properties from type 'User': phone, email, password, bo
nusPoints, and 12 more.

    [7m249[0m       const mockUser: User = {
    [7m   [0m [91m                             ~[0m
    [7m250[0m         id: 'user-1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m255[0m         role: UserRole.CLIENT,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m256[0m       } as User;
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m
    [96msrc/modules/auth/auth.service.spec.ts[0m:[93m289[0m:[93m34[0m - [91merror[0m[90m TS2352: [0mConversion of type '{ id: string; telegramId: number; firstName: string; lastName: string; userna
me: string; role: UserRole.CLIENT; }' to type 'User' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
      Type '{ id: string; telegramId: number; firstName: string; lastName: string; username: string; role: UserRole.CLIENT; }' is missing the following properties from type 'User': phone, email, password, bo
nusPoints, and 12 more.

    [7m289[0m       const existingUser: User = {
    [7m   [0m [91m                                 ~[0m
    [7m290[0m         id: 'user-1',
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m295[0m         role: UserRole.CLIENT,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m296[0m       } as User;
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m


Test Suites: 2 failed, 28 passed, 30 total
Tests:       286 passed, 286 total
Snapshots:   0 total
Time:        13.084 s
Ran all test suites.
