# План объединения Telegram функций в одну страницу

## Цель
Объединить всю работу с Telegram в одну удобную страницу `/admin/telegram` с продуманным UI.

## Текущая структура
- `/admin/telegram` - работа с ботом (отправка сообщений, управление чатами, автоответы, запланированные сообщения)
- `/admin/telegram-auth` - авторизация пользователя (телефон/QR/2FA)
- `/admin/telegram-user` - отправка личных сообщений от имени пользователя

## Новая структура

### Главные табы страницы `/admin/telegram`:

1. **Бот** (существующий функционал)
   - Подтабы:
     - Отправка сообщений
     - Управление чатом
     - Группы и чаты
     - Участники
     - Планировщик
     - Настройки (автоответы, приветственные сообщения)

2. **Авторизация** (новый - перенести из `/telegram-auth`)
   - Авторизация по телефону
   - Авторизация через QR-код
   - 2FA
   - Индикатор статуса подключения

3. **Личные сообщения** (новый - перенести из `/telegram-user`)
   - Отправка сообщений от имени пользователя
   - Управление сессиями
   - Список чатов и контактов

## План реализации

### Этап 1: Обновление структуры страницы
- [x] Изучить текущую структуру `/admin/telegram/page.tsx`
- [ ] Изменить структуру табов на главные: "Бот", "Авторизация", "Личные сообщения"
- [ ] В табе "Бот" оставить подтабы (send, manage, chats, members, scheduled, settings)

### Этап 2: Перенос функционала авторизации
- [ ] Создать компонент `TelegramAuthTab` на основе `telegram-auth/page.tsx`
- [ ] Добавить проверку статуса авторизации
- [ ] Интегрировать в главный таб "Авторизация"

### Этап 3: Перенос функционала личных сообщений
- [ ] Создать компонент `TelegramUserMessagesTab` на основе `telegram-user/page.tsx`
- [ ] Интегрировать в главный таб "Личные сообщения"

### Этап 4: Обновление навигации
- [ ] Обновить Sidebar: оставить только одну ссылку `/telegram`
- [ ] Обновить AuthGuard: удалить проверки для `/telegram-auth`
- [ ] Обновить LayoutContent: удалить исключения для `/telegram-auth`

### Этап 5: Удаление старых страниц
- [ ] Удалить `/admin/telegram-auth/page.tsx`
- [ ] Удалить `/admin/telegram-user/page.tsx`
- [ ] Обновить все ссылки на старые страницы

### Этап 6: Улучшение UI
- [ ] Добавить индикатор статуса авторизации в заголовок
- [ ] Улучшить визуальное разделение секций
- [ ] Добавить карточки статуса

## Технические детали

### Компоненты для создания:
1. `TelegramAuthTab` - таб авторизации
2. `TelegramUserMessagesTab` - таб личных сообщений
3. `AuthStatusIndicator` - индикатор статуса авторизации

### API эндпоинты (уже существуют):
- `/auth/telegram/phone/request` - запрос кода
- `/auth/telegram/phone/verify` - проверка кода
- `/auth/telegram/qr/generate` - генерация QR
- `/auth/telegram/qr/status/:tokenId` - статус QR
- `/auth/telegram/2fa/verify` - проверка 2FA
- `/telegram/user/chats` - список чатов
- `/telegram/user/contacts` - список контактов
- `/telegram/user/send-message` - отправка сообщения
- `/telegram/user/send-media` - отправка медиа
- `/telegram/user/sessions` - список сессий
- `/telegram/user/sessions/:sessionId` - деактивация сессии

## UI/UX улучшения

1. **Индикатор статуса** в заголовке страницы:
   - Зеленый значок + "Подключено" если есть активная сессия
   - Красный значок + "Не подключено" если нет сессии
   - Кнопка "Подключить" если не подключено

2. **Карточки статуса**:
   - Статус бота (активен/неактивен)
   - Статус авторизации пользователя
   - Количество активных сессий

3. **Визуальное разделение**:
   - Четкое разделение между табами
   - Иконки для каждого таба
   - Подсветка активного таба

