# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞ Afrodita

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 23.01.2026  
**–ú–µ—Ç–æ–¥:** –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Context7 –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
docker compose build
docker compose up -d
docker compose logs -f
docker compose down
```

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
npm install
npm run dev
```

### –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ Ubuntu

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ docker compose.

---

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Å—Å–∞–∂–Ω—ã–º —Å–∞–ª–æ–Ω–æ–º —Å Telegram-–±–æ—Ç–æ–º, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- Backend: NestJS, TypeORM, PostgreSQL, Redis, Telegram MTProto
- Admin: Next.js 14, React, TypeScript
- Landing: React, Vite, TypeScript
- Telegram App: React, Vite, TypeScript

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π backend —Å –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è frontend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å 2FA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (PASSWORD_HASH_INVALID)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî —Å–∞–º–æ–ø–∏—Å–Ω—ã–π SRP –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `checkPassword` –∏–∑ `@mtkruto/node`

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –í `verify2FAPasswordWithStored`: `ap = await client.invoke(account.getPassword)`; `input = await checkPassword(password, ap)`; `client.invoke(auth.checkPassword, { password: input })`. –°–∞–º–æ–ø–∏—Å–Ω—ã–π SRP (~250 —Å—Ç—Ä–æ–∫) —É–¥–∞–ª—ë–Ω.
- ‚úÖ `tssrp6a` —É–¥–∞–ª–µ–Ω–∞ –∏–∑ `package.json`.
- ‚ö†Ô∏è –¢–µ—Å—Ç—ã –¥–ª—è 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Äî –ø–æ –ø–ª–∞–Ω—É ¬ß8 (auth)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `auth.service.ts`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `checkPassword` –∏–∑ `@mtkruto/node` (–∞–Ω–∞–ª–æ–≥ client.computeCheck, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è SRP –ø–æ MTProto)
- ‚úÖ –°–±–æ—Ä–∫–∞ backend –ø—Ä–æ—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `checkPassword(password, ap)` –∏–∑ `@mtkruto/node` (account.getPassword ‚Üí ap)
2. ‚úÖ –£–¥–∞–ª–∏—Ç—å —Å–∞–º–æ–ø–∏—Å–Ω—ã–π –∫–æ–¥ SRP –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
3. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ (–≤ —Ä–∞–º–∫–∞—Ö ¬ß8)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∏ 1476-1674)

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 2. –ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ message.includes() –≤–Ω–µ mapper

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî isRequire2faActionError –≤ mapper, –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–±—Ä–∞–Ω—ã –∏–∑ handler –∏ auth.service.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ `isRequire2faActionError` –∏ –¥—Ä. –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `telegram-error-mapper.ts`; –≤—Å–µ `message.includes()` —É–±—Ä–∞–Ω—ã –∏–∑ `mtproto-error.handler.ts` –∏ `auth.service.ts`.

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ mtproto-error.handler.ts ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ mapper
- ‚úÖ auth.service.ts ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ mapper, –±–µ–∑ message.includes

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `telegram-error-mapper.ts`
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `isFatalTelegramError`, `isRetryableTelegramError`, `isRequire2faActionError` –∏–∑ mapper
3. ‚úÖ –£–¥–∞–ª–∏—Ç—å –≤—Å–µ `message.includes()` –∏–∑ mtproto-error.handler –∏ auth.service
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å auth.service –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è mapper

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/telegram/utils/mtproto-error.handler.ts`
- `backend/src/modules/auth/auth.service.ts`
- `backend/src/modules/telegram/utils/telegram-error-mapper.ts` (—Ä–∞—Å—à–∏—Ä–∏—Ç—å)

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî appointments, reviews —Å page/limit; notifications sendBroadcast .take(5000).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ `appointments.service` ‚Äî findAll —Å page/limit (PaginationDto, normalizePagination)
- ‚úÖ `reviews.service` ‚Äî findAll —Å page/limit
- ‚úÖ `notifications.service` ‚Äî sendBroadcast —Å .take(5000) –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ appointments ‚Äî –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ reviews ‚Äî –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ notifications ‚Äî –ª–∏–º–∏—Ç 5000 –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤ appointments –∏ reviews
2. ‚úÖ –õ–∏–º–∏—Ç –≤ notifications.sendBroadcast
3. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è limit (PaginationDto, max 100) ‚Äî —Å–º. ¬ß6

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/appointments/appointments.service.ts`
- `backend/src/modules/reviews/reviews.service.ts`
- `backend/src/modules/notifications/notifications.service.ts`
- DTO –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

### 4. TypeScript strict mode –æ—Ç–∫–ª—é—á–µ–Ω

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û** ‚Äî strict: true, strictNullChecks, noImplicitAny –≤–∫–ª—é—á–µ–Ω—ã; —Å–±–æ—Ä–∫–∞ OK

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `backend/tsconfig.json`: `strict: true`, strictNullChecks, noImplicitAny (—Å–±–æ—Ä–∫–∞ OK)
- ‚úÖ `noFallthroughCasesInSwitch`, `noImplicitReturns`, `noUnusedLocals` –≤–∫–ª—é—á–µ–Ω—ã

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ strict: true ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã: `error` –≤ catch ‚Üí getErrorMessage/getErrorStack (auth.service, jwt.service, notifications.service, scheduler.service, telegram-session.guard); InvokeClient+–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤ invokeWithRetry (mtproto-retry.utils, telegram-session.guard, telegram-heartbeat, telegram-user-client√ó3); `return (await client.invoke(request)) as T` –≤ mtproto-retry

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ noFallthroughCasesInSwitch, noImplicitReturns, noUnusedLocals
2. ‚úÖ strictNullChecks, noImplicitAny
3. ‚úÖ strict: true ‚Äî error.message/stack‚ÜígetErrorMessage/getErrorStack; InvokeClient –¥–ª—è @mtkruto Client; mtproto-retry return as T
4. –¢–µ—Å—Ç—ã ‚Äî –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/tsconfig.json`
- –§–∞–π–ª—ã —Å –æ—à–∏–±–∫–∞–º–∏ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ strictNullChecks/noImplicitAny

**–û—Ü–µ–Ω–∫–∞:** 8-12 —á–∞—Å–æ–≤ (—á–∞—Å—Ç–∏—á–Ω–æ)

---

### 5. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–∞ `any`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî options/keyboard –∏ keyboard-–º–∞—Å—Å–∏–≤—ã –≤ telegram-bot —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ `sendMessage(chatId, message, options?)` ‚Üí `Types.ExtraReplyMessage`; `sendMessageWithKeyboard(..., keyboard)` ‚Üí `Types.ExtraReplyMessage`
- ‚úÖ `sendPrivateReply(..., options?)` ‚Üí `Types.ExtraReplyMessage`; `reply_to_message_id` –ø—Ä–∏ fallback ‚Üí `as Types.ExtraReplyMessage`
- ‚úÖ `sendPrivateCallbackReply(..., keyboard?, options?)` ‚Üí `keyboard?: { reply_markup?: Types.ExtraReplyMessage['reply_markup'] }`, `options?: Types.ExtraReplyMessage`; `editMessageText` reply_markup ‚Üí `as ExtraEditMessageText['reply_markup']`
- ‚úÖ `keyboard: any[]` ‚Üí `unknown[][]` (–∫–∞–ª–µ–Ω–¥–∞—Ä—å, –∑–∞–ø–∏—Å–∏√ó2); `currentRow: any[]` ‚Üí `unknown[]`; `keyboardButtons: any[]` ‚Üí `unknown[][]`; –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Å Telegraf: `Markup.inlineKeyboard(keyboard as never)` (HideableIKBtn[][] –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `backend/src/modules/telegram/telegram-bot.service.ts` ‚Äî —Å–±–æ—Ä–∫–∞ —Å strict: true –ø—Ä–æ—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ entity, chatInfo, apt/appointment.*, role, availableMasters, user, promo, faq, selectedServices, servicesToBook
2. ‚úÖ options/keyboard –≤ sendMessage, sendMessageWithKeyboard, sendPrivateReply, sendPrivateCallbackReply ‚Äî Types.ExtraReplyMessage –∏ { reply_markup }
3. ‚úÖ keyboard-–º–∞—Å—Å–∏–≤—ã ‚Äî unknown[][], unknown[]; –Ω–∞ –≤—ã–∑–æ–≤–µ Markup.inlineKeyboard ‚Äî `as never`

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/telegram/telegram-bot.service.ts`

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤ (–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞)

---

### 6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è limit

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî PaginationDto, normalizePagination (max 100) –≤ users, services, masters, appointments, reviews.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ PaginationDto –∏ `normalizePagination(..., { max: 100 })` –≤ users, services, masters, appointments, reviews.

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ users, services, masters, appointments, reviews ‚Äî limit –æ–≥—Ä–∞–Ω–∏—á–µ–Ω (max 100)

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ PaginationDto —Å @Max(100) –¥–ª—è limit
2. ‚úÖ normalizePagination –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö/—Å–µ—Ä–≤–∏—Å–∞—Ö
3. ‚úÖ –¥–µ—Ñ–æ–ª—Ç limit=20, max=100

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/common/dto/pagination.dto.ts` (—Å–æ–∑–¥–∞—Ç—å)
- –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è ReferralService

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî —Å–æ–∑–¥–∞–Ω referral.service.spec.ts, –ø–æ–∫—Ä—ã—Ç—ã generateReferralCode, getOrGenerateReferralCode, getUserByReferralCode, processReferralRegistration, getReferralStats.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –§–∞–π–ª `referral.service.spec.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ —Ç–µ—Å—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å `referral.service.spec.ts`
2. –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –≤—Å–µ –º–µ—Ç–æ–¥—ã:
   - `generateReferralCode()`
   - `getOrGenerateReferralCode()`
   - `getUserByReferralCode()`
   - `processReferralRegistration()`
   - `getReferralStats()`
3. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
- `backend/src/modules/users/referral.service.spec.ts`

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 8. –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–æ–¥—É–ª—è auth (—á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –§–∞–π–ª `auth.service.spec.ts` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã
- ‚úÖ –ï—Å—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `validateEmailPassword` —Å edge cases (SQL injection, –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏)
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ (`checkPasswordWith2FA`)
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Local —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –§–∞–π–ª `backend/src/modules/auth/auth.service.spec.ts` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (886 —Å—Ç—Ä–æ–∫)
- ‚ùå –§–∞–π–ª `backend/src/modules/auth/strategies/jwt.strategy.spec.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚ùå –§–∞–π–ª `backend/src/modules/auth/strategies/local.strategy.spec.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚ö†Ô∏è –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `checkPasswordWith2FA` –º–µ—Ç–æ–¥–∞
2. –°–æ–∑–¥–∞—Ç—å `jwt.strategy.spec.ts` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
3. –°–æ–∑–¥–∞—Ç—å `local.strategy.spec.ts` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Local —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
4. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
- `backend/src/modules/auth/strategies/jwt.strategy.spec.ts` (—Å–æ–∑–¥–∞—Ç—å)
- `backend/src/modules/auth/strategies/local.strategy.spec.ts` (—Å–æ–∑–¥–∞—Ç—å)
- –†–∞—Å—à–∏—Ä–∏—Ç—å `backend/src/modules/auth/auth.service.spec.ts` (–¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è 2FA)

**–û—Ü–µ–Ω–∫–∞:** 6-10 —á–∞—Å–æ–≤

---

## –í–ê–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

### 9. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û –†–ê–ù–ï–ï** ‚Äî main, data-source, database.config: –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è production, –±–µ–∑ fallback.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `main.ts` —Å—Ç—Ä–æ–∫–∞ 139: `'your-session-secret-key-change-me'` –∫–∞–∫ fallback (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –í `data-source.ts` —Å—Ç—Ä–æ–∫–∏ 10-14: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `'localhost'`, `'postgres'`, `'postgres'` (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –í `database.config.ts` —Å—Ç—Ä–æ–∫–∏ 12-16: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ë–î (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –†–∏—Å–∫ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –≤ production

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å fallback –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ production

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ production
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
3. –í—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É, –µ—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ production
4. –û–±–Ω–æ–≤–∏—Ç—å `env.validation.ts` –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ production

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/main.ts`
- `backend/src/config/data-source.ts`
- `backend/src/config/database.config.ts`
- `backend/src/config/env.validation.ts`

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 10. –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û –†–ê–ù–ï–ï** ‚Äî telegram-bot: FRONTEND_URL –∏–∑ env, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `telegram-bot.service.ts:4474` –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω URL: `'https://your-domain.com'` (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ–≥–æ –∫–æ–¥–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL

**–†–µ—à–µ–Ω–∏–µ:**
1. –í—ã–Ω–µ—Å—Ç–∏ –≤—Å–µ URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é URL –≤ `env.validation.ts`
3. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/telegram/telegram-bot.service.ts`
- `backend/src/config/env.validation.ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

---

### 11. –ù–µ–ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û –†–ê–ù–ï–ï** ‚Äî env.validation: ValidateIf, MinLength(32), IsUrl –¥–ª—è FRONTEND/ADMIN, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –≤ prod.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- **–í–°–ï** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `@IsOptional()` (38 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ production
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ URL, email –∏ —Ç.–¥.
- –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è `env.validation.ts`
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –≤—Å–µ –µ—â–µ –≤—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è production (JWT_SECRET, DB_PASSWORD, SESSION_SECRET)
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ –¥–ª—è URL (`@IsUrl()`)
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (`@MinLength(32)`)
4. –†–∞–∑–¥–µ–ª–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏–π
5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ValidateIf` –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/config/env.validation.ts`

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

### 12. TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî RegisterDto, MediaPreview, TelegramUserMessagesTab (–¥–∏–∞–ª–æ–≥ –ø–µ—Ä–µ—Å—ã–ª–∫–∏) –≥–æ—Ç–æ–≤—ã.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ RegisterDto —Å–æ–∑–¥–∞–Ω
- ‚úÖ MediaPreview: GET /telegram/user/file, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ fetch+blob, fileReference
- ‚úÖ TelegramUserMessagesTab: –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏, forwardMutation (POST .../forward), —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤+–∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ TODO –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —É–¥–∞–ª—ë–Ω; –∑–∞–≥–ª—É—à–∫–∞ toast.info —É–±—Ä–∞–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å `RegisterDto` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ —Å–æ–∑–¥–∞–Ω)
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Telegram API
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/auth/controllers/auth.controller.ts` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å)
- `backend/src/modules/auth/dto/register.dto.ts` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ —Å–æ–∑–¥–∞–Ω)
- `admin/app/telegram/components/MediaPreview.tsx`
- `admin/app/telegram/TelegramUserMessagesTab.tsx`

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 13. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî authLimiter –Ω–∞ /api/v1/auth/login –∏ /api/v1/auth/register.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- Rate limiting –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ `main.ts:171-172`
- –ù–µ—Ç rate limiting –Ω–∞ `/api/v1/auth/login`
- –ù–µ—Ç rate limiting –Ω–∞ `/api/v1/auth/register`

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùå `backend/src/main.ts:171-172` - rate limiting –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- ‚ùå –ù–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `authLimiter` –Ω–∞ auth endpoints

**–†–µ—à–µ–Ω–∏–µ:**
1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å rate limiting
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å `authLimiter` –Ω–∞ `/api/v1/auth/login`
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å `authLimiter` –Ω–∞ `/api/v1/auth/register`
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints

**–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

---

### 14. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @ts-ignore –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî @ts-ignore —É–±—Ä–∞–Ω—ã; –≤ telegram-user ‚Äî as any –¥–ª—è invoke

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ `@ts-ignore` –≤ backend —É–±—Ä–∞–Ω—ã
- –í `telegram-user.controller.ts` @ts-expect-error –Ω–µ –Ω–∞–π–¥–µ–Ω; –¥–ª—è `client.invoke( {...} )` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `as any` –Ω–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö (–Ω–∞–ø—Ä. `id: [messageIdNum] as any`, `random_id: [BigInt(...)] as any`, –≤–µ—Å—å –æ–±—ä–µ–∫—Ç `as any`). –ü—Ä–∏—á–∏–Ω–∞: —Ç–∏–ø—ã @mtkruto –¥–ª—è Api (messages.sendMessage, messages.deleteMessages, messages.forwardMessages –∏ –¥—Ä.) —Å—Ç—Ä–æ–∂–µ runtime-—Å—Ç—Ä—É–∫—Ç—É—Ä (number[] vs readonly, BigInt, –≤–ª–æ–∂–µ–Ω–Ω—ã–µ InputPeer –∏ —Ç.–¥.).

**–£–≥–ª—É–±–ª—ë–Ω–Ω–æ (¬ß14):**
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ @mtkruto –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Ç–∏–ø–æ–≤ –¥–ª—è messages.* –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã; –¥–æ —Ç–µ—Ö –ø–æ—Ä `as any` –Ω–∞ invoke-–∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö –æ—Å—Ç–∞–≤–∏—Ç—å.
- `telegram.service` (restrictChatMember, Markup.inlineKeyboard), `telegram-user-client` (Storage, DatabaseStorage) ‚Äî –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ç–æ—á–µ—á–Ω—ã–µ `as any` –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Å Telegraf/MTKruto.

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

### 15. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî body parser limit 10mb (BODY_PARSER_LIMIT); @MaxLength –≤ DTO (broadcast, telegram, contact, template, service, appointment).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
- –†–∏—Å–∫ DoS —á–µ—Ä–µ–∑ –±–æ–ª—å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å body parser limits –≤ NestJS

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 16. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî financial.processPayment: manager.transaction –¥–ª—è updateBonusPoints + save(transaction).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –†–∏—Å–∫ race conditions –∏ –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è `financial.service.ts:processPayment()` - –Ω–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è bonusPoints –∏ —Å–æ–∑–¥–∞–Ω–∏—è transaction
- ‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ `processPayment()`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@Transactional()` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –∏–ª–∏ —è–≤–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

## –£–õ–£–ß–®–ï–ù–ò–Ø (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)

### 17. –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û** ‚Äî retry –¥–ª—è MTProto: invokeWithRetry –≤ getMe/users.getFullUser (user-client 3√ó, heartbeat, guard).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ï–¥–∏–Ω—ã–π ErrorResponse –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ exception filters –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ValidationError[]
- ‚úÖ Retry –¥–ª—è Telegram MTProto: `invokeWithRetry` –ø—Ä–∏ FLOOD_WAIT/retryable (getMe 5√ó)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `HttpExceptionFilter` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
- ‚úÖ `ValidationExceptionFilter` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç React error #31
- ‚úÖ `ErrorMetricsService` —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ Retry –ø—Ä–∏ RETRY (FLOOD_WAIT –∏ –¥—Ä.): mtproto-retry.utils, user-client, heartbeat, guard

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É –¥–ª—è Telegram API –≤—ã–∑–æ–≤–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å circuit breaker –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. –£–ª—É—á—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 18. –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** üîÑ –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: 51.23% statements, 37.79% branches
- –¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: >80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

**–û—Ü–µ–Ω–∫–∞:** 16-24 —á–∞—Å–∞

---

### 19. –£–ª—É—á—à–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî Prometheus-–º–µ—Ç—Ä–∏–∫–∏, /metrics

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏: prom-client, http_requests_total, http_request_duration_seconds; MetricsInterceptor (finalize); GET /metrics (text/plain) –¥–ª—è Prometheus/Grafana
- ‚úÖ MetricsModule, /metrics –≤ exclude –∏ –≤ /api, /api/v1; ErrorMetricsService (–æ—à–∏–±–∫–∏ –ø–æ ErrorCode) ‚Äî –±—ã–ª —Ä–∞–Ω–µ–µ

**–û—Ü–µ–Ω–∫–∞:** 8-12 —á–∞—Å–æ–≤

---

### 20. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û** ‚Äî –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, N+1 –∞—É–¥–∏—Ç

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã: maxQueryExecutionTime (DB_SLOW_QUERY_MS, –ø–æ —É–º–æ–ª—á. 5000 –≤ prod), TypeOrmSlowQueryLogger (logQuerySlow) –≤ production
- ‚úÖ –ê—É–¥–∏—Ç N+1: appointments, notifications ‚Äî relations/–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å; –º–∞—Å—Å–æ–≤—ã–µ find –≤ —Ü–∏–∫–ª–∞—Ö –Ω–µ –≤—ã—è–≤–ª–µ–Ω—ã
- –ò–Ω–¥–µ–∫—Å—ã ‚Äî —Ä–∞–Ω–µ–µ; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ query runner –¥–ª—è –º–µ—Ç—Ä–∏–∫

**–û—Ü–µ–Ω–∫–∞:** 6-8 —á–∞—Å–æ–≤

---

### 21. –£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û** ‚Äî —Ç–µ–≥–∏ Swagger

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ Swagger: –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ–≥–∏ health, metrics, settings, financial, reviews, audit, templates, contact-requests, telegram, scheduler (–∫ auth, appointments, services, masters, users, notifications, analytics)
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —Å @ApiTags, @ApiOperation ‚Äî –±—ã–ª–∏; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: @ApiBody, DTO-—Å—Ö–µ–º—ã

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

## BACKEND

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–ú–æ–¥—É–ª–∏:**
- ‚úÖ –•–æ—Ä–æ—à–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeORM
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã ‚Äî message.includes –≤ mapper (¬ß2)
- ‚úÖ TypeScript strict: true, strictNullChecks, noImplicitAny (—Å–±–æ—Ä–∫–∞ OK)
- ‚ö†Ô∏è any: telegram-bot —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω (¬ß5); –≤ notifications, telegram-user-client, auth, users, http-exception.filter, telegram-user.controller –∏ –¥—Ä. ‚Äî –æ—Å—Ç–∞—é—Ç—Å—è; —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—Å—è DTO –∏ unknown/–ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è ‚Äî appointments, reviews; notifications sendBroadcast .take(5000) (¬ß3)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- NestJS 10.3.0
- TypeORM 0.3.17
- PostgreSQL —á–µ—Ä–µ–∑ TypeORM
- Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- Telegram MTProto —á–µ—Ä–µ–∑ @mtkruto/node

---

## FRONTEND

### Admin (Next.js)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ Next.js 14 —Å App Router
- ‚úÖ TypeScript
- ‚úÖ Tailwind CSS

### Telegram App (React + Vite)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ React 18
- ‚úÖ Vite –¥–ª—è —Å–±–æ—Ä–∫–∏
- ‚úÖ TypeScript

### Landing (React + Vite)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ React 18
- ‚úÖ Vite –¥–ª—è —Å–±–æ—Ä–∫–∏
- ‚úÖ Tailwind CSS

---

## –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å 2FA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (4-6 —á–∞—Å–æ–≤) ‚Äî checkPassword –∏–∑ @mtkruto/node, —Å–∞–º–æ–ø–∏—Å–Ω—ã–π SRP —É–¥–∞–ª—ë–Ω, tssrp6a —É–¥–∞–ª–µ–Ω–∞
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ (2-3 —á–∞—Å–∞) ‚Äî isRequire2faActionError –≤ mapper, —É–±—Ä–∞–Ω—ã message.includes –∏–∑ handler –∏ auth.service
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (3-4 —á–∞—Å–∞) ‚Äî appointments, reviews, notifications.sendBroadcast .take(5000)
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ limit (2-3 —á–∞—Å–∞) ‚Äî PaginationDto, normalizePagination(max 100) –≤ 5 –º–æ–¥—É–ª—è—Ö
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è ReferralService (4-6 —á–∞—Å–æ–≤) ‚Äî referral.service.spec.ts
6. ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–æ–¥—É–ª—è auth (6-10 —á–∞—Å–æ–≤) ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ; –Ω—É–∂–Ω—ã 2FA, JWT, Local

**–ò—Ç–æ–≥–æ:** 21-32 —á–∞—Å–∞

### –§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)

7. ‚úÖ –í–∫–ª—é—á–∏—Ç—å TypeScript strict mode –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ ‚Äî strict: true, strictNullChecks, noImplicitAny (—Å–±–æ—Ä–∫–∞ OK)
8. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ any —Ç–∏–ø—ã –≤ telegram-bot ‚Äî options/keyboard (Types.ExtraReplyMessage, { reply_markup }), keyboard/currentRow/keyboardButtons (unknown[][], unknown[]; Markup.inlineKeyboard as never)
9. ‚úÖ –£–±—Ä–∞—Ç—å @ts-ignore –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (3-4 —á–∞—Å–∞) ‚Äî 6 –º–µ—Å—Ç: 5 —Å–Ω—è—Ç—ã, 1 @ts-expect-error (messages.sendMessage)
10. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (2-3 —á–∞—Å–∞) ‚Äî main, data-source, database.config
11. ‚úÖ –£–±—Ä–∞—Ç—å –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL (1-2 —á–∞—Å–∞) ‚Äî FRONTEND_URL –≤ telegram-bot
12. ‚úÖ –£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (3-4 —á–∞—Å–∞) ‚Äî env.validation: ValidateIf, MinLength, IsUrl
13. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (4-6 —á–∞—Å–æ–≤) ‚Äî RegisterDto, MediaPreview (endpoint + –∑–∞–≥—Ä—É–∑–∫–∞), TelegramUserMessagesTab (–¥–∏–∞–ª–æ–≥ –ø–µ—Ä–µ—Å—ã–ª–∫–∏) –≥–æ—Ç–æ–≤—ã
14. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints (1-2 —á–∞—Å–∞) ‚Äî authLimiter –Ω–∞ /auth/login, /auth/register
15. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (2-3 —á–∞—Å–∞) ‚Äî body 10mb, @MaxLength –≤ DTO
16. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (3-4 —á–∞—Å–∞) ‚Äî processPayment: manager.transaction –¥–ª—è bonusPoints + Transaction
17. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (4-6 —á–∞—Å–æ–≤) ‚Äî retry –¥–ª—è MTProto getMe (invokeWithRetry)

**–ò—Ç–æ–≥–æ:** 35-47 —á–∞—Å–æ–≤

### –§–∞–∑–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (3-4 –Ω–µ–¥–µ–ª–∏)

18. üîÑ –£–ª—É—á—à–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (16-24 —á–∞—Å–∞)
19. ‚úÖ –£–ª—É—á—à–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Äî prom-client, /metrics, http_requests_total, http_request_duration_seconds
20. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î ‚Äî maxQueryExecutionTime, TypeOrmSlowQueryLogger, –∞—É–¥–∏—Ç N+1
21. ‚úÖ –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API ‚Äî —Ç–µ–≥–∏ Swagger (health, metrics, settings, financial, reviews, audit, templates, contact-requests, telegram, scheduler)

**–ò—Ç–æ–≥–æ:** 34-50 —á–∞—Å–æ–≤

---

## –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 90-129 —á–∞—Å–æ–≤ (11-16 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–§–∞–∑–∞ 1) - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
2. –í–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–§–∞–∑–∞ 2) - –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞
3. –£–ª—É—á—à–µ–Ω–∏—è (–§–∞–∑–∞ 3) - –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

---

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- ‚úÖ 2FA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî checkPassword –∏–∑ @mtkruto/node, —Å–∞–º–æ–ø–∏—Å–Ω—ã–π SRP —É–¥–∞–ª—ë–Ω
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–±–ª—é–¥–∞—é—Ç—Å—è ‚Äî message.includes —É–±—Ä–∞–Ω—ã, –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ telegram-error-mapper
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é ‚Äî appointments, reviews; notifications sendBroadcast —Å .take(5000)
- ‚úÖ TypeScript strict: true, strictNullChecks, noImplicitAny, noUnusedLocals (—Å–±–æ—Ä–∫–∞ OK)
- ‚ùå –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π any —Ç–∏–ø–∞
- ‚ö†Ô∏è –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
- ‚úÖ Rate limiting –Ω–∞ auth ‚Äî authLimiter –Ω–∞ /auth/login, /auth/register
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ processPayment ‚Äî manager.transaction –¥–ª—è bonusPoints + Transaction
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî body 10mb, @MaxLength –≤ DTO
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏: /metrics (Prometheus), http_requests_total, http_request_duration_seconds; ErrorMetricsService
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: Swagger, —Ç–µ–≥–∏ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–ª–∞–Ω–æ–≤, –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ —ç—Ç–æ—Ç –ø–ª–∞–Ω

1. **–ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–æ–¥—É–ª—è auth** ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ; —Ç—Ä–µ–±—É—é—Ç—Å—è —Ç–µ—Å—Ç—ã –¥–ª—è 2FA, JWT, Local (¬ß8)
2. **–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤** ‚Äî ‚úÖ ¬ß9: main, data-source, database.config –±–µ–∑ fallback –≤ prod
3. **–ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL** ‚Äî ‚úÖ ¬ß10: telegram-bot, FRONTEND_URL –∏–∑ env
4. **–ù–µ–ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è** ‚Äî ‚úÖ ¬ß11: env.validation, ValidateIf, MinLength, IsUrl
5. **TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ** ‚Äî ‚úÖ ¬ß12: RegisterDto, MediaPreview, TelegramUserMessagesTab
6. **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫** ‚Äî ‚úÖ ¬ß17: retry –¥–ª—è MTProto (invokeWithRetry)

## –ù–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ

1. **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤** ‚Äî ‚úÖ ¬ß2: message.includes –≤ mapper, —É–±—Ä–∞–Ω—ã –∏–∑ handler –∏ auth.service
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏** ‚Äî ‚úÖ ¬ß3: appointments, reviews, notifications.take(5000)
3. **TypeScript strict mode** ‚Äî ‚úÖ strict: true, strictNullChecks, noImplicitAny
4. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è any** ‚Äî ‚ö†Ô∏è telegram-bot —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω (¬ß5); –æ—Å—Ç–∞—é—Ç—Å—è –≤ –¥—Ä. –º–æ–¥—É–ª—è—Ö
5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ limit** ‚Äî ‚úÖ ¬ß6: PaginationDto, normalizePagination(max 100)
6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting** ‚Äî ‚úÖ ¬ß13: authLimiter –Ω–∞ /auth/login, /auth/register
7. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @ts-ignore** ‚Äî ‚úÖ ¬ß14: —É–±—Ä–∞–Ω—ã; as any –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ @mtkruto
8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** ‚Äî ‚úÖ ¬ß16: processPayment —Å manager.transaction

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏ (¬ß8 auth, ¬ß18) ‚Äî –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å
2. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ `error: any` / `e: any` –Ω–∞ `unknown` –∏ getErrorMessage (—Ç–æ—á–µ—á–Ω–æ)
3. –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ any –≤ notifications, telegram-user-client, auth, users –∏ –¥—Ä. (DTO, unknown)
4. –ü—Ä–æ–≤–æ–¥–∏—Ç—å code review –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
5. –û–±–Ω–æ–≤–ª—è—Ç—å REPORT.md –ø–æ –º–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ dev –ø–µ—Ä–µ–¥ production
