# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞ Afrodita

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 23.01.2026  
**–ú–µ—Ç–æ–¥:** –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Context7 –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
docker compose build
docker compose up -d
docker compose logs -f
docker compose down
```

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
npm install
npm run dev
```

### –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ Ubuntu

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ docker compose.

---

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Å—Å–∞–∂–Ω—ã–º —Å–∞–ª–æ–Ω–æ–º —Å Telegram-–±–æ—Ç–æ–º, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- Backend: NestJS, TypeORM, PostgreSQL, Redis, Telegram MTProto
- Admin: Next.js 14, React, TypeScript
- Landing: React, Vite, TypeScript
- Telegram App: React, Vite, TypeScript

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π backend —Å –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è frontend –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å 2FA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (PASSWORD_HASH_INVALID)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî —Å–∞–º–æ–ø–∏—Å–Ω—ã–π SRP –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `checkPassword` –∏–∑ `@mtkruto/node`

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –í `verify2FAPasswordWithStored`: `ap = await client.invoke(account.getPassword)`; `input = await checkPassword(password, ap)`; `client.invoke(auth.checkPassword, { password: input })`. –°–∞–º–æ–ø–∏—Å–Ω—ã–π SRP (~250 —Å—Ç—Ä–æ–∫) —É–¥–∞–ª—ë–Ω.
- ‚úÖ `tssrp6a` —É–¥–∞–ª–µ–Ω–∞ –∏–∑ `package.json`.
- ‚ö†Ô∏è –¢–µ—Å—Ç—ã –¥–ª—è 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Äî –ø–æ –ø–ª–∞–Ω—É ¬ß8 (auth)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `auth.service.ts`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `checkPassword` –∏–∑ `@mtkruto/node` (–∞–Ω–∞–ª–æ–≥ client.computeCheck, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è SRP –ø–æ MTProto)
- ‚úÖ –°–±–æ—Ä–∫–∞ backend –ø—Ä–æ—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `checkPassword(password, ap)` –∏–∑ `@mtkruto/node` (account.getPassword ‚Üí ap)
2. ‚úÖ –£–¥–∞–ª–∏—Ç—å —Å–∞–º–æ–ø–∏—Å–Ω—ã–π –∫–æ–¥ SRP –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
3. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ (–≤ —Ä–∞–º–∫–∞—Ö ¬ß8)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/auth/auth.service.ts` (—Å—Ç—Ä–æ–∫–∏ 1476-1674)

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 2. –ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ message.includes() –≤–Ω–µ mapper

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî isRequire2faActionError –≤ mapper, –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–±—Ä–∞–Ω—ã –∏–∑ handler –∏ auth.service.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `mtproto-error.handler.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `message.includes()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—à–∏–±–æ–∫ (—Å—Ç—Ä–æ–∫–∏ 51, 60-63)
- –≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø, —á—Ç–æ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `telegram-error-mapper.ts`
- –í `auth.service.ts:726` —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `error.message.includes('SESSION_PASSWORD_NEEDED')`

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùå `backend/src/modules/telegram/utils/mtproto-error.handler.ts:51,60-63` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `message.includes()`
- ‚ùå `backend/src/modules/auth/auth.service.ts:726` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `error.message.includes()`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `telegram-error-mapper.ts`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `isFatalTelegramError`, `isRetryableTelegramError` –∏–∑ mapper
3. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ `message.includes()` –∏–∑ `mtproto-error.handler.ts`
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å `auth.service.ts:726` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è mapper

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/telegram/utils/mtproto-error.handler.ts`
- `backend/src/modules/auth/auth.service.ts`
- `backend/src/modules/telegram/utils/telegram-error-mapper.ts` (—Ä–∞—Å—à–∏—Ä–∏—Ç—å)

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî appointments, reviews —Å page/limit; notifications sendBroadcast .take(5000).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `appointments.service.ts:231` - `findAll()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –ª–∏–º–∏—Ç–∞
- `reviews.service.ts:99` - `findAll()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –ª–∏–º–∏—Ç–∞
- `notifications.service.ts:294` - –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ª–∏–º–∏—Ç–∞

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùå `backend/src/modules/appointments/appointments.service.ts:231` - –Ω–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- ‚ùå `backend/src/modules/reviews/reviews.service.ts:99` - –Ω–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- ‚ö†Ô∏è `backend/src/modules/notifications/notifications.service.ts:294` - –Ω–µ—Ç –ª–∏–º–∏—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ `appointments.service.ts:findAll()`
2. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ `reviews.service.ts:findAll()`
3. –î–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ `notifications.service.ts`
4. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è limit (–Ω–∞–ø—Ä–∏–º–µ—Ä, max 100)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/appointments/appointments.service.ts`
- `backend/src/modules/reviews/reviews.service.ts`
- `backend/src/modules/notifications/notifications.service.ts`
- DTO –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

### 4. TypeScript strict mode –æ—Ç–∫–ª—é—á–µ–Ω

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê –¢–ò–ü–û–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò** ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ: –≤–∫–ª—é—á–µ–Ω—ã noFallthroughCasesInSwitch, noImplicitReturns; strict/strictNullChecks/noImplicitAny ‚Äî –Ω–µ—Ç

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `backend/tsconfig.json`: `strict: false`, strictNullChecks, noImplicitAny –∏ –¥—Ä. ‚Äî –≤—ã–∫–ª—é—á–µ–Ω—ã
- ‚úÖ `noFallthroughCasesInSwitch: true`, `noImplicitReturns: true`, `noUnusedLocals: true` (—Å–±–æ—Ä–∫–∞ OK)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `backend/tsconfig.json` ‚Äî noFallthroughCasesInSwitch, noImplicitReturns, noUnusedLocals –≤–∫–ª—é—á–µ–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ –ü–µ—Ä–≤—ã–π —à–∞–≥: noFallthroughCasesInSwitch, noImplicitReturns
2. ‚úÖ noUnusedLocals ‚Äî —É–±—Ä–∞–Ω—ã ‚âà61 –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–∞/–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ 6 –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ (jwt.service ConfigService; jwt.strategy AuthService; telegram-connection-monitor TelegramUserClientService; referral.service Transaction; auth.service JwtService, TelegramSessionService)
3. –î–∞–ª–µ–µ: strictNullChecks ‚Äî ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (settings, telegram-user-client, telegram-user.controller, auth, telegram.service, telegram-bot.service; —Å–±–æ—Ä–∫–∞ OK); noImplicitAny (~75), strict: true
4. –ò—Å–ø—Ä–∞–≤–ª—è—Ç—å –æ—à–∏–±–∫–∏ –ø–æ –º–µ—Ä–µ –≤–∫–ª—é—á–µ–Ω–∏—è

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/tsconfig.json`
- –§–∞–π–ª—ã —Å –æ—à–∏–±–∫–∞–º–∏ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ strictNullChecks/noImplicitAny

**–û—Ü–µ–Ω–∫–∞:** 8-12 —á–∞—Å–æ–≤ (—á–∞—Å—Ç–∏—á–Ω–æ)

---

### 5. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–∞ `any`

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê –¢–ò–ü–û–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò** ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å –≤ telegram-bot –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞; –æ—Å—Ç–∞—é—Ç—Å—è `options`/`keyboard` –≤ sendMessage/sendPrivate*, `keyboard: any[]`, `currentRow`, `selectedServices`, `servicesToBook`, `keyboardButtons`.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ `auth.controller.ts`: `error: unknown`, `req: ExpressRequest`, getErrorMessage/getErrorStack
- ‚úÖ `telegram-bot.service.ts`:
  - `catch (error: any)` ‚Üí `unknown`, getErrorMessage/getErrorStack
  - `ctx: any` ‚Üí `Context`, `chat: any` ‚Üí `ChatLike`; —Ç–∏–ø—ã `ChatLike`, `ReplaceVarsUser`
  - `(entity: any)` ‚Üí `MentionEntity`; `(chatInfo as any)` ‚Üí `ChatInfoFromApi` (getChat)
  - `(apt.service as any)`, `(appointment.service as any)` ‚Üí `WithName`; `(apt.master as any)`, `(appointment.master as any)` ‚Üí `WithName`; `(appointmentWithRelations.master as any)` ‚Üí `MasterLike` (id, userId, name)
  - `(apt.client as any)`, `(appointment.client as any)`, `(appointmentWithRelations.client as any)` ‚Üí `ClientLike`
  - `role: 'client' as any` ‚Üí `UserRole.CLIENT`
  - `availableMasters: any[]` ‚Üí `Master[]`; `user: any` ‚Üí `User | null`; `promo: any`, `item: any` –≤ forEach ‚Äî —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã (promotions, faq)
  - `(ctx.callbackQuery as any).data` ‚Üí –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ; `ctx.message.text` –≤ handleBroadcastMessage ‚Üí `(ctx.message as { text?: string })?.text ?? ''`
  - ‚úÖ `selectedServices`, `servicesToBook` ‚Üí `Service[]`
  - ‚ö†Ô∏è –û—Å—Ç–∞–≤–ª–µ–Ω—ã `any`: `options`/`keyboard` –≤ sendMessage, sendPrivateReply, sendPrivateCallbackReply; `keyboard: any[]`, `currentRow`, `keyboardButtons` (—Ç–∏–ø—ã Telegraf HideableIKBtn –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å push/row-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `backend/src/modules/telegram/telegram-bot.service.ts` ‚Äî —Å–±–æ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚úÖ entity, chatInfo, apt/appointment.service|master|client, appointmentWithRelations, role, availableMasters, user, promo, faq
2. –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Ç–∏–ø–æ–≤ Telegraf ‚Äî —É–±—Ä–∞—Ç—å `any` —É options/keyboard –≤ sendMessage/sendPrivate*
3. ‚ö†Ô∏è keyboard-–º–∞—Å—Å–∏–≤—ã: Telegraf HideableIKBtn[][] –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ push; –æ—Å—Ç–∞–≤–ª–µ–Ω—ã any[]. –ü—Ä–∏ –∞–ø–≥—Ä–µ–π–¥–µ Telegraf/—Ç–∏–ø–æ–≤ ‚Äî –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å.

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/telegram/telegram-bot.service.ts`

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤ (–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞)

---

### 6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è limit

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî PaginationDto, normalizePagination (max 100) –≤ users, services, masters, appointments, reviews.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è `limit` –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –º–∏–ª–ª–∏–æ–Ω –∑–∞–ø–∏—Å–µ–π, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ DoS

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùå `users.controller.ts` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ limit
- ‚ùå `services.controller.ts` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ limit
- ‚ùå `masters.controller.ts` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ limit

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å DTO –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π `@Max(100)` –¥–ª—è limit
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å DTO –≤–æ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö
3. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ limit=20, max=100

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/common/dto/pagination.dto.ts` (—Å–æ–∑–¥–∞—Ç—å)
- –í—Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è ReferralService

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî —Å–æ–∑–¥–∞–Ω referral.service.spec.ts, –ø–æ–∫—Ä—ã—Ç—ã generateReferralCode, getOrGenerateReferralCode, getUserByReferralCode, processReferralRegistration, getReferralStats.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –§–∞–π–ª `referral.service.spec.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ —Ç–µ—Å—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å `referral.service.spec.ts`
2. –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –≤—Å–µ –º–µ—Ç–æ–¥—ã:
   - `generateReferralCode()`
   - `getOrGenerateReferralCode()`
   - `getUserByReferralCode()`
   - `processReferralRegistration()`
   - `getReferralStats()`
3. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
- `backend/src/modules/users/referral.service.spec.ts`

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 8. –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–æ–¥—É–ª—è auth (—á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –§–∞–π–ª `auth.service.spec.ts` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã
- ‚úÖ –ï—Å—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `validateEmailPassword` —Å edge cases (SQL injection, –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏)
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ (`checkPasswordWith2FA`)
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Local —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ –§–∞–π–ª `backend/src/modules/auth/auth.service.spec.ts` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (886 —Å—Ç—Ä–æ–∫)
- ‚ùå –§–∞–π–ª `backend/src/modules/auth/strategies/jwt.strategy.spec.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚ùå –§–∞–π–ª `backend/src/modules/auth/strategies/local.strategy.spec.ts` –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚ö†Ô∏è –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ 2FA –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `checkPasswordWith2FA` –º–µ—Ç–æ–¥–∞
2. –°–æ–∑–¥–∞—Ç—å `jwt.strategy.spec.ts` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
3. –°–æ–∑–¥–∞—Ç—å `local.strategy.spec.ts` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Local —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
4. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
- `backend/src/modules/auth/strategies/jwt.strategy.spec.ts` (—Å–æ–∑–¥–∞—Ç—å)
- `backend/src/modules/auth/strategies/local.strategy.spec.ts` (—Å–æ–∑–¥–∞—Ç—å)
- –†–∞—Å—à–∏—Ä–∏—Ç—å `backend/src/modules/auth/auth.service.spec.ts` (–¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è 2FA)

**–û—Ü–µ–Ω–∫–∞:** 6-10 —á–∞—Å–æ–≤

---

## –í–ê–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

### 9. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û –†–ê–ù–ï–ï** ‚Äî main, data-source, database.config: –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è production, –±–µ–∑ fallback.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `main.ts` —Å—Ç—Ä–æ–∫–∞ 139: `'your-session-secret-key-change-me'` –∫–∞–∫ fallback (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –í `data-source.ts` —Å—Ç—Ä–æ–∫–∏ 10-14: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `'localhost'`, `'postgres'`, `'postgres'` (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –í `database.config.ts` —Å—Ç—Ä–æ–∫–∏ 12-16: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ë–î (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –†–∏—Å–∫ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –≤ production

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å fallback –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ production

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ production
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
3. –í—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É, –µ—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ production
4. –û–±–Ω–æ–≤–∏—Ç—å `env.validation.ts` –¥–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ production

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/main.ts`
- `backend/src/config/data-source.ts`
- `backend/src/config/database.config.ts`
- `backend/src/config/env.validation.ts`

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 10. –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û –†–ê–ù–ï–ï** ‚Äî telegram-bot: FRONTEND_URL –∏–∑ env, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –í `telegram-bot.service.ts:4474` –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω URL: `'https://your-domain.com'` (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ–≥–æ –∫–æ–¥–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL

**–†–µ—à–µ–Ω–∏–µ:**
1. –í—ã–Ω–µ—Å—Ç–∏ –≤—Å–µ URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é URL –≤ `env.validation.ts`
3. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/telegram/telegram-bot.service.ts`
- `backend/src/config/env.validation.ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—Ä—É–≥–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

---

### 11. –ù–µ–ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û –†–ê–ù–ï–ï** ‚Äî env.validation: ValidateIf, MinLength(32), IsUrl –¥–ª—è FRONTEND/ADMIN, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –≤ prod.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- **–í–°–ï** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `@IsOptional()` (38 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ production
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ URL, email –∏ —Ç.–¥.
- –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏–π

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è `env.validation.ts`
- ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –≤—Å–µ –µ—â–µ –≤—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è production (JWT_SECRET, DB_PASSWORD, SESSION_SECRET)
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ –¥–ª—è URL (`@IsUrl()`)
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (`@MinLength(32)`)
4. –†–∞–∑–¥–µ–ª–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–ª—è dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏–π
5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ValidateIf` –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/config/env.validation.ts`

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

### 12. TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî RegisterDto, MediaPreview, TelegramUserMessagesTab (–¥–∏–∞–ª–æ–≥ –ø–µ—Ä–µ—Å—ã–ª–∫–∏) –≥–æ—Ç–æ–≤—ã.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ RegisterDto —Å–æ–∑–¥–∞–Ω
- ‚úÖ MediaPreview: GET /telegram/user/file, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ fetch+blob, fileReference
- ‚úÖ TelegramUserMessagesTab: –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏, forwardMutation (POST .../forward), —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤+–∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ TODO –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —É–¥–∞–ª—ë–Ω; –∑–∞–≥–ª—É—à–∫–∞ toast.info —É–±—Ä–∞–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å `RegisterDto` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ —Å–æ–∑–¥–∞–Ω)
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Telegram API
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞ –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `backend/src/modules/auth/controllers/auth.controller.ts` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å)
- `backend/src/modules/auth/dto/register.dto.ts` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–æ–∑–º–æ–∂–Ω–æ —É–∂–µ —Å–æ–∑–¥–∞–Ω)
- `admin/app/telegram/components/MediaPreview.tsx`
- `admin/app/telegram/TelegramUserMessagesTab.tsx`

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 13. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî authLimiter –Ω–∞ /api/v1/auth/login –∏ /api/v1/auth/register.

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- Rate limiting –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ `main.ts:171-172`
- –ù–µ—Ç rate limiting –Ω–∞ `/api/v1/auth/login`
- –ù–µ—Ç rate limiting –Ω–∞ `/api/v1/auth/register`

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ùå `backend/src/main.ts:171-172` - rate limiting –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- ‚ùå –ù–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `authLimiter` –Ω–∞ auth endpoints

**–†–µ—à–µ–Ω–∏–µ:**
1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å rate limiting
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å `authLimiter` –Ω–∞ `/api/v1/auth/login`
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å `authLimiter` –Ω–∞ `/api/v1/auth/register`
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints

**–û—Ü–µ–Ω–∫–∞:** 1-2 —á–∞—Å–∞

---

### 14. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @ts-ignore –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî –≤—Å–µ @ts-ignore —É–±—Ä–∞–Ω—ã; 1 @ts-expect-error —Ç–æ–ª—å–∫–æ –≥–¥–µ –Ω—É–∂–µ–Ω

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ 6 `@ts-ignore` –≤ backend: 5 —É–¥–∞–ª–µ–Ω—ã (Unused ‚Äî —Ç–∏–ø. –æ—à–∏–±–æ–∫ –Ω–µ –±—ã–ª–æ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ `as any` –∏–ª–∏ —Ç–µ–∫—É—â–∏—Ö —Ç–∏–ø–æ–≤), 1 –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `@ts-expect-error` –≤ `telegram-user.controller.ts` (messages.sendMessage/invoke, —Ç–∏–ø—ã @mtkruto)
- ‚úÖ auth, telegram-user-client (DatabaseStorage, new Client), telegram.service (restrictChatMember) ‚Äî –¥–∏—Ä–µ–∫—Ç–∏–≤—ã —Å–Ω—è—Ç—ã, –∫—Ä–∞—Ç–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≥–¥–µ –Ω—É–∂–Ω–æ

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `auth.service.ts` ‚Äî @ts-ignore —Å–Ω—è—Ç
- ‚úÖ `telegram-user-client.service.ts` ‚Äî 2 —Å–Ω—è—Ç—ã; JSDoc –¥–ª—è DatabaseStorage
- ‚úÖ `telegram-user.controller.ts` ‚Äî @ts-expect-error –æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è invoke
- ‚úÖ `telegram.service.ts` ‚Äî 2 —Å–Ω—è—Ç—ã; –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–æ as any

**–†–µ—à–µ–Ω–∏–µ:**
1. ‚ö†Ô∏è –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Ç–∏–ø–æ–≤ MTProto/Storage –≤ @mtkruto ‚Äî —É–±—Ä–∞—Ç—å –æ—Å—Ç–∞–≤—à–∏–π—Å—è @ts-expect-error
2. ‚úÖ –£–±—Ä–∞—Ç—å –≤—Å–µ `@ts-ignore`
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@ts-expect-error` —Ç–æ–ª—å–∫–æ –≥–¥–µ —Ä–µ–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ —Ç–∏–ø–æ–≤

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

### 15. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî body parser limit 10mb (BODY_PARSER_LIMIT); @MaxLength –≤ DTO (broadcast, telegram, contact, template, service, appointment).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
- –†–∏—Å–∫ DoS —á–µ—Ä–µ–∑ –±–æ–ª—å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å body parser limits –≤ NestJS

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

---

### 16. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û** ‚Äî financial.processPayment: manager.transaction –¥–ª—è updateBonusPoints + save(transaction).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –†–∏—Å–∫ race conditions –∏ –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚ö†Ô∏è `financial.service.ts:processPayment()` - –Ω–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è bonusPoints –∏ —Å–æ–∑–¥–∞–Ω–∏—è transaction
- ‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ `processPayment()`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@Transactional()` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –∏–ª–∏ —è–≤–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

---

## –£–õ–£–ß–®–ï–ù–ò–Ø (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)

### 17. –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û** ‚Äî retry –¥–ª—è MTProto: invokeWithRetry –≤ getMe/users.getFullUser (user-client 3√ó, heartbeat, guard).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ï–¥–∏–Ω—ã–π ErrorResponse –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ exception filters –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ValidationError[]
- ‚úÖ Retry –¥–ª—è Telegram MTProto: `invokeWithRetry` –ø—Ä–∏ FLOOD_WAIT/retryable (getMe 5√ó)

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- ‚úÖ `HttpExceptionFilter` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
- ‚úÖ `ValidationExceptionFilter` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç React error #31
- ‚úÖ `ErrorMetricsService` —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫
- ‚úÖ Retry –ø—Ä–∏ RETRY (FLOOD_WAIT –∏ –¥—Ä.): mtproto-retry.utils, user-client, heartbeat, guard

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É –¥–ª—è Telegram API –≤—ã–∑–æ–≤–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å circuit breaker –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
3. –£–ª—É—á—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

### 18. –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** üîÑ –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: 51.23% statements, 37.79% branches
- –¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: >80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

**–û—Ü–µ–Ω–∫–∞:** 16-24 —á–∞—Å–∞

---

### 19. –£–ª—É—á—à–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** üîÑ –£–ª—É—á—à–µ–Ω–∏–µ observability

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ë–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –µ—Å—Ç—å
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–û—Ü–µ–Ω–∫–∞:** 8-12 —á–∞—Å–æ–≤

---

### 20. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

**–°—Ç–∞—Ç—É—Å:** üîÑ –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ò–Ω–¥–µ–∫—Å—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å N+1 –ø—Ä–æ–±–ª–µ–º—ã
- –ù–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–û—Ü–µ–Ω–∫–∞:** 6-8 —á–∞—Å–æ–≤

---

### 21. –£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API

**–°—Ç–∞—Ç—É—Å:** üîÑ –£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

---

## BACKEND

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–ú–æ–¥—É–ª–∏:**
- ‚úÖ –•–æ—Ä–æ—à–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeORM
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚ùå –ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ (message.includes –≤–Ω–µ mapper)
- ‚ùå TypeScript strict mode –æ—Ç–∫–ª—é—á–µ–Ω
- ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è any —Ç–∏–ø–∞
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- NestJS 10.3.0
- TypeORM 0.3.17
- PostgreSQL —á–µ—Ä–µ–∑ TypeORM
- Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- Telegram MTProto —á–µ—Ä–µ–∑ @mtkruto/node

---

## FRONTEND

### Admin (Next.js)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ Next.js 14 —Å App Router
- ‚úÖ TypeScript
- ‚úÖ Tailwind CSS

### Telegram App (React + Vite)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ React 18
- ‚úÖ Vite –¥–ª—è —Å–±–æ—Ä–∫–∏
- ‚úÖ TypeScript

### Landing (React + Vite)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ React 18
- ‚úÖ Vite –¥–ª—è —Å–±–æ—Ä–∫–∏
- ‚úÖ Tailwind CSS

---

## –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å 2FA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (4-6 —á–∞—Å–æ–≤) ‚Äî checkPassword –∏–∑ @mtkruto/node, —Å–∞–º–æ–ø–∏—Å–Ω—ã–π SRP —É–¥–∞–ª—ë–Ω, tssrp6a —É–¥–∞–ª–µ–Ω–∞
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ (2-3 —á–∞—Å–∞) ‚Äî isRequire2faActionError –≤ mapper, —É–±—Ä–∞–Ω—ã message.includes –∏–∑ handler –∏ auth.service
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (3-4 —á–∞—Å–∞) ‚Äî appointments, reviews, notifications.sendBroadcast .take(5000)
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ limit (2-3 —á–∞—Å–∞) ‚Äî PaginationDto, normalizePagination(max 100) –≤ 5 –º–æ–¥—É–ª—è—Ö
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è ReferralService (4-6 —á–∞—Å–æ–≤) ‚Äî referral.service.spec.ts
6. ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–æ–¥—É–ª—è auth (6-10 —á–∞—Å–æ–≤) ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ; –Ω—É–∂–Ω—ã 2FA, JWT, Local

**–ò—Ç–æ–≥–æ:** 21-32 —á–∞—Å–∞

### –§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (2-3 –Ω–µ–¥–µ–ª–∏)

7. ‚ö†Ô∏è –í–∫–ª—é—á–∏—Ç—å TypeScript strict mode –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ (8-12 —á–∞—Å–æ–≤) ‚Äî noFallthroughCasesInSwitch, noImplicitReturns ‚úÖ; strictNullChecks, noImplicitAny ‚Äî –¥–∞–ª–µ–µ
8. ‚ö†Ô∏è –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ any —Ç–∏–ø—ã (4-6 —á–∞—Å–æ–≤) ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ: telegram-bot entity, chatInfo, apt/appointment.*, appointmentWithRelations, role, availableMasters, user, promo, faq; –æ—Å—Ç–∞—é—Ç—Å—è options/keyboard –≤ sendMessage/sendPrivate*, keyboard-–º–∞—Å—Å–∏–≤—ã
9. ‚úÖ –£–±—Ä–∞—Ç—å @ts-ignore –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (3-4 —á–∞—Å–∞) ‚Äî 6 –º–µ—Å—Ç: 5 —Å–Ω—è—Ç—ã, 1 @ts-expect-error (messages.sendMessage)
10. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (2-3 —á–∞—Å–∞) ‚Äî main, data-source, database.config
11. ‚úÖ –£–±—Ä–∞—Ç—å –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL (1-2 —á–∞—Å–∞) ‚Äî FRONTEND_URL –≤ telegram-bot
12. ‚úÖ –£–ª—É—á—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (3-4 —á–∞—Å–∞) ‚Äî env.validation: ValidateIf, MinLength, IsUrl
13. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (4-6 —á–∞—Å–æ–≤) ‚Äî RegisterDto, MediaPreview (endpoint + –∑–∞–≥—Ä—É–∑–∫–∞), TelegramUserMessagesTab (–¥–∏–∞–ª–æ–≥ –ø–µ—Ä–µ—Å—ã–ª–∫–∏) –≥–æ—Ç–æ–≤—ã
14. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ endpoints (1-2 —á–∞—Å–∞) ‚Äî authLimiter –Ω–∞ /auth/login, /auth/register
15. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (2-3 —á–∞—Å–∞) ‚Äî body 10mb, @MaxLength –≤ DTO
16. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (3-4 —á–∞—Å–∞) ‚Äî processPayment: manager.transaction –¥–ª—è bonusPoints + Transaction
17. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (4-6 —á–∞—Å–æ–≤) ‚Äî retry –¥–ª—è MTProto getMe (invokeWithRetry)

**–ò—Ç–æ–≥–æ:** 35-47 —á–∞—Å–æ–≤

### –§–∞–∑–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (3-4 –Ω–µ–¥–µ–ª–∏)

18. üîÑ –£–ª—É—á—à–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (16-24 —á–∞—Å–∞)
19. üîÑ –£–ª—É—á—à–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (8-12 —á–∞—Å–æ–≤)
20. üîÑ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î (6-8 —á–∞—Å–æ–≤)
21. üîÑ –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API (4-6 —á–∞—Å–æ–≤)

**–ò—Ç–æ–≥–æ:** 34-50 —á–∞—Å–æ–≤

---

## –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 90-129 —á–∞—Å–æ–≤ (11-16 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
1. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–§–∞–∑–∞ 1) - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
2. –í–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–§–∞–∑–∞ 2) - –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞
3. –£–ª—É—á—à–µ–Ω–∏—è (–§–∞–∑–∞ 3) - –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

---

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- ‚úÖ 2FA –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî checkPassword –∏–∑ @mtkruto/node, —Å–∞–º–æ–ø–∏—Å–Ω—ã–π SRP —É–¥–∞–ª—ë–Ω
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–±–ª—é–¥–∞—é—Ç—Å—è ‚Äî message.includes —É–±—Ä–∞–Ω—ã, –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ telegram-error-mapper
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏—é ‚Äî appointments, reviews; notifications sendBroadcast —Å .take(5000)
- ‚ö†Ô∏è TypeScript strict: noFallthroughCasesInSwitch, noImplicitReturns, noUnusedLocals –≤–∫–ª—é—á–µ–Ω—ã; strict/strictNullChecks ‚Äî –Ω–µ—Ç
- ‚ùå –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π any —Ç–∏–ø–∞
- ‚ö†Ô∏è –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
- ‚úÖ Rate limiting –Ω–∞ auth ‚Äî authLimiter –Ω–∞ /auth/login, /auth/register
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ processPayment ‚Äî manager.transaction –¥–ª—è bonusPoints + Transaction
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî body 10mb, @MaxLength –≤ DTO
- ‚ö†Ô∏è –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –ø–æ–ª–Ω–∞—è

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–ª–∞–Ω–æ–≤, –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ —ç—Ç–æ—Ç –ø–ª–∞–Ω

1. **–ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–æ–¥—É–ª—è auth** - —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è 2FA, JWT –∏ Local —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
2. **–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤** - –≤—Å–µ –µ—â–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞
3. **–ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL** - –≤—Å–µ –µ—â–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞
4. **–ù–µ–ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è** - –≤—Å–µ –µ—â–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞
5. **TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ** - –≤—Å–µ –µ—â–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
6. **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫** - —Ö–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º—ã

## –ù–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ

1. **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ message.includes() –≤–Ω–µ mapper
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏** - –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏
3. **TypeScript strict mode –æ—Ç–∫–ª—é—á–µ–Ω** - –ø—Ä–æ–±–ª–µ–º—ã —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è any** - 30+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ limit** - —Ä–∏—Å–∫ DoS
6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting** - –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ main.ts
7. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @ts-ignore** - 7 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** - –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤
3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:** –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
4. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3:** –í–∫–ª—é—á–∏—Ç—å TypeScript strict mode –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
5. –ü—Ä–æ–≤–µ—Å—Ç–∏ code review –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã
6. –û–±–Ω–æ–≤–ª—è—Ç—å REPORT.md –ø–æ –º–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –ø–µ—Ä–µ–¥ production
